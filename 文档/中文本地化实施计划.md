# 中文本地化实施计划

## 目标与范围
- 将应用界面、项目页面（LVGL/Flow/仪表盘）、组件文档统一支持中文（简体，`zh-CN`）
- 保持英文为默认回退，确保缺失翻译不影响功能

## 阶段与里程碑
- 阶段一（项目页面）
  - 建立 `Language` 与 `TextResource` 体系，补齐关键页面文案
  - 在控件属性中绑定 `TextResource` 并使用语言切换进行验证
- 阶段二（应用界面）
  - 为首页、设置页、项目编辑器常用操作建立消息字典并替换硬编码英文
  - 逐步覆盖低频页面与提示
- 阶段三（组件文档）
  - 准备中文 Markdown 描述，生成 `docs/components/html/zh-CN` 文档
  - 与英文版本保持目录结构一致

## 应用层本地化
- 切换语言到中文：在设置页执行语言切换（保存到主进程设置，重启生效）
  - `packages/eez-studio-shared/i10n.ts:141-152`
  - `packages/main/settings.ts:409-415`
  - `packages/home/settings.tsx:203-207`
- 日期/时间格式：按需设置 `DATE_FORMATS` 与 `TIME_FORMATS`
  - `packages/eez-studio-shared/i10n.ts:158-167,184-197`
  - `packages/main/settings.ts:417-431`

## 项目页面本地化
- 添加中文语言：在 Project Editor 的 Texts 中新增 `Language.languageID = "zh-CN"`
  - `packages/project-editor/features/texts/index.tsx:156-199`
- 维护翻译：在每个 `TextResource.translations` 中填写中文；未翻译提示用来排查
  - `packages/project-editor/features/texts/index.tsx:116-130`
- 绑定控件：在控件的文本属性表达式中引用 `TextResource`，该节点类型视为 `string`
  - `packages/project-editor/flow/expression/type.ts:63-65`
- 预览验证：使用工具栏语言选择器切换到 `zh-CN` 检查页面
  - `packages/project-editor/project/ui/Toolbar.tsx:526-556`

## 应用界面本地化（React 组件）
- 建立消息字典：在共享层维护 `{key -> zh-CN/en}` 映射，运行时依据 `getLocale()` 选择
- 替换硬编码：将首页、设置页、Project Editor 常用按钮与提示改用字典查找
- 英文回退：缺失键自动显示英文，避免出现空白
- 推进顺序：设置页 → 首页 → 项目编辑器工具栏与导航 → 其他模块

## 组件文档本地化
- 生成目录参数化：将文档生成目标从 `en-US` 切换到 `zh-CN`
  - `packages/home/documentation-browser/generate-html.tsx:71-83`
- 同步资源：复制 `help/zh-CN/components/images` 到目标目录
- 内容来源：为各组件准备中文 Markdown（属性/输入/输出/示例）

## 术语与质量保障
- 术语表：建立控件、动作、流程等中英术语对照，统一风格
- 文案规范：尽量短句、避免歧义，与控件功能一致
- 覆盖统计：用 Texts 统计视图查看翻译完成度
  - `packages/project-editor/features/texts/navigation.tsx:343-371`
- 运行检查：在 `zh-CN` 下完整走项目编辑/构建/运行，关注布局与文本长度

## 验收清单
- 设置页语言切换到 `zh-CN` 正常且持久化
- 项目关键页面的控件文案全部来自 `TextResource` 且翻译完整
- 首页与设置页主要 UI 文本显示中文，英文为回退
- 组件中文文档生成到 `docs/components/html/zh-CN`，资源正确复制

## 参考文件
- 语言与格式接口：`packages/eez-studio-shared/i10n.ts`
- 设置持久化与 IPC：`packages/main/settings.ts`
- 设置页语言切换：`packages/home/settings.tsx`
- 文本资源与翻译检查：`packages/project-editor/features/texts/index.tsx`
- 编辑器语言选择器：`packages/project-editor/project/ui/Toolbar.tsx`
- 表达式节点类型：`packages/project-editor/flow/expression/type.ts`
- 文档生成器：`packages/home/documentation-browser/generate-html.tsx`
